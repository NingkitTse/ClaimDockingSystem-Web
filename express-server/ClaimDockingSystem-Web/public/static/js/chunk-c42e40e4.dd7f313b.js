(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c42e40e4"],{"0e96":function(e){e.exports={ownDept:"text",ownTransStation:"text",voltageLevel:"text",assetNo:"text",deviceNo:"text",manufacturer:"text",putIntoDate:"time",serviceEnv:"text",longitude:"lng",latitude:"lat",assetValue:"text",acquisitionValue:"text",conventionalDepreciation:"text",netAssetValue:"text",policyNumber:"text",insuredUnits:"text",primaryUnderwriteUnit:"text",insuranceType:"text",insurance:"text",rate:"text",insuranceStartTime:"time",insuranceEndTime:"time",pickUpCaseSerialNo:"text",reportNo:"text",insuranceEffectType:"text",insuranceEffectReason:"text",payDate:"text",payAmount:"text",reportSerialNo:"text",cxUnit:"text",theInsured:"text",cxTime:"time",cxArea:"text",insuranceAmount:"text",assetLossAmount:"text",claimeAmout:"text",reporter:"text",reporterTel:"tel",reportTime:"time",cxSurvey:"text",cxSurveyTel:"tel",insuranceSurvey:"text",insuranceSurveyTel:"tel",reserved:"text"}},1508:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"device-table-container"},[n("el-radio-group",{model:{value:e.searchBy,callback:function(t){e.searchBy=t},expression:"searchBy"}},[n("el-radio-button",{attrs:{label:!0}},[e._v("通过供电公司\\供电所搜索设备")]),e._v(" "),n("el-radio-button",{attrs:{label:!1}},[e._v("通过GIS搜索设备")])],1),e._v(" "),e.searchBy?n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-form-item",{staticClass:"image-checkbox-item",staticStyle:{"margin-top":"20px"},attrs:{label:"供电公司"}},[n("el-checkbox-group",{on:{change:function(t){return e.onchangeCompany()}},model:{value:e.form.powerSupplyCompany,callback:function(t){e.$set(e.form,"powerSupplyCompany",t)},expression:"form.powerSupplyCompany"}},e._l(e.supplyCompanies,(function(e){return n("el-checkbox-button",{key:e.name,attrs:{label:e.name,title:e.name}},[n("el-image",{staticClass:"checkbox-img",attrs:{fit:"cover",lazy:"",src:e.src}})],1)})),1)],1),e._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.supplyAdmins&&e.supplyAdmins.length>0,expression:"supplyAdmins && supplyAdmins.length > 0"}],staticStyle:{"margin-top":"20px"},attrs:{label:"供电所"}},[n("el-checkbox-group",{on:{change:function(t){return e.onchangeFormCond()}},model:{value:e.form.powerSupplyAdmin,callback:function(t){e.$set(e.form,"powerSupplyAdmin",t)},expression:"form.powerSupplyAdmin"}},e._l(e.supplyAdmins,(function(e){return n("el-checkbox-button",{key:e,attrs:{label:e}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"功能"}},[n("el-button",{on:{click:function(t){return e.exportSelection()}}},[e._v("导出选中数据")]),e._v(" "),n("el-button",{staticClass:"el-icon-search",on:{click:function(t){return e.queryEntites()}}},[e._v(" 重新查询")])],1)],1):n("el-form",{ref:"gisForm",staticClass:"gis-form",attrs:{"label-width":"80px"}},[n("baidu-map",{staticClass:"map-div",attrs:{center:e.center,zoom:e.zoom,"scroll-wheel-zoom":!0},on:{ready:e.handlerMapInitHouseDetail,click:e.getMapClickInfo}}),e._v(" "),this.bounds?n("el-form-item",{attrs:{label:"边界信息"}},[n("span",{staticClass:"bound-item"},[e._v("\n        界面西经： "),n("span",[e._v(e._s(this.bounds.Zd))])]),e._v(" "),n("span",{staticClass:"bound-item"},[e._v("\n        界面东经： "),n("span",[e._v(e._s(this.bounds.Xd))])]),e._v(" "),n("span",{staticClass:"bound-item"},[e._v("\n        界面北纬： "),n("span",[e._v(e._s(this.bounds.Ne))])]),e._v(" "),n("span",{staticClass:"bound-item"},[e._v("\n        界面南纬： "),n("span",[e._v(e._s(this.bounds.Je))])])]):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"功能"}},[n("el-button",{on:{click:function(t){return e.exportSelection()}}},[e._v("导出选中数据")]),e._v(" "),n("el-button",{staticClass:"el-icon-search",on:{click:function(t){return e.queryEntites()}}},[e._v(" 重新查询")])],1)],1),e._v(" "),n("div",{staticClass:"table-container"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"ID",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.$index+1)+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"资产名称",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.assetName)+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"",align:"center",label:"设备照片",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.imgPaths&&t.row.imgPaths.length>0?n("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{"preview-src-list":t.row.imgPaths,src:t.row.imgPaths[0],fit:"cover",lazy:""}}):e._e()]}}])}),e._v(" "),e._l(e.entityNameMap,(function(t,i){return n("el-table-column",{key:i,attrs:{label:t,resizable:"","min-width":"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row[i])+"\n        ")]}}],null,!0)})})),e._v(" "),n("el-table-column",{attrs:{"min-width":"95",fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon-edit icon",attrs:{title:"上传图片"},on:{click:function(n){return e.showEditPanel(t.row)}}})]}}])})],2),e._v(" "),n("div",{staticClass:"footer"},[n("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next, total, jumper",total:e.total,"page-size":e.pageSize,"current-page":e.current,"pager-count":11,"page-sizes":[10,20,50,100,200]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"编辑设备详情",visible:e.displayEditPanel,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.displayEditPanel=t}}},[n("article",[n("el-form",{ref:"deviceForm",attrs:{rules:e.entityRule,model:e.selectedEntity,"label-width":"100px"}},[e._l(e.entityNameMap,(function(t,i){return n("el-form-item",{key:i,staticClass:"image-checkbox-item",attrs:{prop:i,label:t}},["text"==e.getEntityType(i)?n("el-input",{model:{value:e.selectedEntity[i],callback:function(t){e.$set(e.selectedEntity,i,t)},expression:"selectedEntity[key]"}}):"lng"==e.getEntityType(i)?n("el-input",{attrs:{type:"number",max:180,min:-180},model:{value:e.selectedEntity[i],callback:function(t){e.$set(e.selectedEntity,i,t)},expression:"selectedEntity[key]"}}):"lat"==e.getEntityType(i)?n("el-input",{attrs:{type:"number",max:90,min:-90},model:{value:e.selectedEntity[i],callback:function(t){e.$set(e.selectedEntity,i,t)},expression:"selectedEntity[key]"}}):"tel"==e.getEntityType(i)?n("el-input",{attrs:{type:"tel",max:90,min:-90},model:{value:e.selectedEntity[i],callback:function(t){e.$set(e.selectedEntity,i,t)},expression:"selectedEntity[key]"}}):n("div",{staticClass:"block"},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间",align:"right","picker-options":e.pickerOptions},model:{value:e.selectedEntity[i],callback:function(t){e.$set(e.selectedEntity,i,t)},expression:"selectedEntity[key]"}})],1)],1)})),e._v(" "),n("el-upload",{staticClass:"upload-demo",attrs:{action:e.backEndBaseUrl+"/device-img/info","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:3,"on-exceed":e.handleExceed,"file-list":e.uploadFileList,"list-type":"picture",data:e.selectedEntity,headers:{"X-Token":e.getToken()}}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],2)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.displayEditPanel=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEdit()}}},[e._v("确 定")])],1)])],1)},r=[],a=(n("309f"),n("0b53"),n("06a2"),n("ec25"),n("2b45"),n("b081")),o=(n("b449"),n("17d6")),s=(n("6d57"),n("2ef9")),l=(n("cc57"),n("ed63"),n("8cf2"),n("b775"));function c(e,t){var n=document.createElement("a"),i=new Blob([JSON.stringify(e,null,4)]);n.download=t,n.href=URL.createObjectURL(i),n.click()}function u(e){return Object(l["a"])({url:"/entity/infos",method:"post",headers:{"Content-Type":"application/json"},data:e})}function p(e){return Object(l["a"])({url:"/entity/info",method:"put",headers:{"Content-Type":"application/json"},data:e})}function d(e){return Object(l["a"])({url:"/entity/gis/infos",method:"post",headers:{"Content-Type":"application/json"},data:e})}function m(e){return Object(l["a"])({url:"/device-img/info",method:"delete",headers:{"Content-Type":"application/json"},data:e})}var f=n("5f30"),h=n("0e96"),y=n("83d6"),v=n("5f87");function g(e){var t=e.BMap,n=e.map,i=new t.Point(this.center.lng,this.center.lat);n.centerAndZoom(i,13);var r=this.marker=new t.Marker(i);n.addOverlay(r);var a=new t.Circle(i,6,{strokeColor:"Red",strokeWeight:6,strokeOpacity:1,Color:"Red",fillColor:"#f03"});n.addOverlay(a)}function b(e){this.marker&&this.map.removeOverlay(this.marker);var t=new BMap.Point(e.point.lng,e.point.lat),n=this.marker=new BMap.Marker(t);this.map.remove,this.map.addOverlay(n),this.queryEntites()}var x,w=[{validator:function(e,t,n){var i="电话号码";""===t&&n(new Error("请输入".concat(i)));var r=/^1[3456789]\d{9}$/;r.test(t)||n(new Error("".concat(i,"格式不正确"))),n()},trigger:"blur"}],E={longitude:[{validator:function(e,t,n){var i="经度";""===t&&n(new Error("请输入".concat(i)));var r=/^-?((0|1?[0-7]?[0-9]?)(([.][0-9]{1,4})?)|180(([.][0]{1,4})?))$/;r.test(t)||n(new Error("".concat(i,"格式不正确"))),n()},trigger:"blur"}],latitude:[{validator:function(e,t,n){var i="纬度";""===t&&n(new Error("请输入".concat(i)));var r=/^-?((0|[1-8]?[0-9]?)(([.][0-9]{1,4})?)|90(([.][0]{1,4})?))$/;r.test(t)||n(new Error("".concat(i,"格式不正确"))),n()},trigger:"blur"}],reporterTel:w,cxSurveyTel:w,insuranceSurveyTel:w};function k(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,a=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw r}}}}function _(e,t){if(e){if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var S=(x={filters:{statusFilter:function(e){var t={published:"success",draft:"gray",deleted:"danger"};return t[e]}},data:function(){var e=["酒店","加油站","学校","医院","地铁"];return{entityRule:E,backEndBaseUrl:y["backEndBaseUrl"],form:{powerSupplyCompany:[],powerSupplyAdmin:[]},searchBy:!0,selectedEntity:f,supplyCompanies:[{name:"国家电网",src:"static/img/powerSupplyCompany/stateGridCorporationOfChina.jpg",supplyAdmins:["所属变电站"]},{name:"湖南省电网",src:"static/img/powerSupplyCompany/chinaGuoDian.jpg",supplyAdmins:["涟源所","伏口所","七星所","枫杨所","涟源城区","茅白所"]}],supplyAdmins:[],multipleSelection:[],list:null,current:1,total:10,pageSize:20,listLoading:!0,entityNameMap:f,displayEditPanel:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},uploadFileList:[],zoom:15,center:{lng:111.67,lat:27.7},myKeys:e,checkAll:!0,checkedKeys:["酒店","加油站","学校","医院","地铁"],map:{}}},created:function(){this.queryEntites()},methods:{getToken:v["a"],onchangeCompany:function(){var e,t=this.supplyAdmins=[],n=this.form.powerSupplyCompany,i=k(this.supplyCompanies);try{for(i.s();!(e=i.n()).done;){var r=e.value;n.includes(r.name)&&t.push.apply(t,Object(s["a"])(r.supplyAdmins))}}catch(a){i.e(a)}finally{i.f()}this.form.powerSupplyAdmin=this.form.powerSupplyAdmin.filter((function(e){return t.includes(e)})),this.queryEntites()},onchangeFormCond:function(){this.queryEntites()},handleSelectionChange:function(e){this.multipleSelection=e},exportSelection:function(){c(this.multipleSelection,"导出数据.json")},processEntityInfos:function(e){this.listLoading=!1;var t,n=[],i=this.list=(n=e.data).records,r=k(i);try{var a=function(){var e=t.value,n=e.deviceImgs||[];if(!n.length)return"continue";var i=[];n.forEach((function(e){e.imgPath=y["backEndBaseUrl"]+e.imgPath,i.push(e.imgPath)})),e.imgPaths=i};for(r.s();!(t=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}this.total=n.total,this.current=n.current,this.pageSize=n.size},queryEntites:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.listLoading=!0,!this.searchBy){e.next=6;break}t={current:this.current,size:this.pageSize,ownDept:this.form.powerSupplyCompany,ownTransStation:this.form.powerSupplyAdmin},u(t).then((function(e){return i.processEntityInfos(e)})),e.next=11;break;case 6:if(this.map){e.next=8;break}return e.abrupt("return");case 8:this.bounds=this.map.getBounds(),n=Object.assign({},this.bounds,{current:this.current,size:this.pageSize}),d(n).then((function(e){return i.processEntityInfos(e)}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getEntityType:function(e){return h[e]||"text"},handleSizeChange:function(e){this.pageSize=e,this.queryEntites()},handleCurrentChange:function(e){this.current=e,this.queryEntites()},showEditPanel:function(e){this.displayEditPanel=!0,e.fileList=e.fileList||[];var t=this.selectedEntity=Object.assign({},e);if(this.uploadFileList=[],t.deviceImgs&&t.deviceImgs.length){var n,i=k(t.deviceImgs);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.uploadFileList.push({url:r.imgPath,name:r.imgName,deviceImgId:r.deviceImgId})}}catch(a){i.e(a)}finally{i.f()}}},handleClose:function(){var e=this;this.$confirm("确认关闭？").then((function(t){e.displayEditPanel=!1,done()})).catch((function(e){}))},handleRemove:function(e,t){var n=this;m(e).then((function(e){n.queryEntites()}))},handlePreview:function(e){this.queryEntites()},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},submitEdit:function(){var e=this;this.$refs["deviceForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.displayEditPanel=!1,p(e.selectedEntity).then((function(t){e.queryEntites()})),console.info("submit!")}))},handlerMapInit:g,getMapClickInfo:b,handlerMapInitHouseDetail:function(e){var t=this,n=e.BMap,i=e.map;g.call(this,{BMap:n,map:i}),this.map=i;var r=new n.ScaleControl({anchor:BMAP_ANCHOR_TOP_LEFT}),a=new n.NavigationControl,o=new n.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL});i.addControl(r),i.addControl(a),i.addControl(o),this.marker.setAnimation(BMAP_ANIMATION_BOUNCE),i.addEventListener("zoomend",(function(e){e.eventType,e.target;t.queryEntites()})),this.queryEntites()}}},Object(a["a"])(x,"filters",{processSrc:function(e){return n("d91c")(e)}}),Object(a["a"])(x,"watch",{searchBy:function(){this.searchBy&&this.queryEntites()}}),x),T=S,A=(n("9a08"),n("e90a")),O=Object(A["a"])(T,i,r,!1,null,"a819d70a",null);t["default"]=O.exports},"5f30":function(e){e.exports={ownDept:"所属单位",ownTransStation:"所属变电站",voltageLevel:"电压等级",assetNo:"资产编码",deviceNo:"设备编号",manufacturer:"生产厂家",putIntoDate:"投运日期",serviceEnv:"使用环境",longitude:"经度",latitude:"纬度",assetValue:"资产价值",acquisitionValue:"购置价值",conventionalDepreciation:"常规折旧",netAssetValue:"账面净值",policyNumber:"保单号",insuredUnits:"投保单位",primaryUnderwriteUnit:"主承保公司",insuranceType:"险种",insurance:"保险金额",rate:"费率",insuranceStartTime:"保险起始时间",insuranceEndTime:"保险结束时间",pickUpCaseSerialNo:"接案流水号",reportNo:"报案号",insuranceEffectType:"出险险种",insuranceEffectReason:"出险原因",payDate:"赔付日期",payAmount:"赔付金额",reportSerialNo:"报案流水号",cxUnit:"出险单位",theInsured:"被保险人",cxTime:"出险时间",cxArea:"出险地域",insuranceAmount:"投保金额",assetLossAmount:"估损金额",claimeAmout:"索赔金额",reporter:"报案人",reporterTel:"报案人电话",reportTime:"报案时间",cxSurvey:"出险公司查勘人",cxSurveyTel:"出险公司查勘人电话",insuranceSurvey:"保险公司查勘人",insuranceSurveyTel:"保险公司查勘人电话",reserved:"其他有用的数据字段"}},"7c0a":function(e,t,n){var i=n("2fd4"),r=n("f6b4");e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(e))}},"820a":function(e,t,n){},"8cf2":function(e,t,n){"use strict";var i=n("e46b"),r=n("7c0a"),a="includes";i(i.P+i.F*n("bc96")(a),"String",{includes:function(e){return!!~r(this,e,a).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},"9a08":function(e,t,n){"use strict";var i=n("820a"),r=n.n(i);r.a},bc96:function(e,t,n){var i=n("cb3d")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(r){}}return!0}},d91c:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="d91c"},ed63:function(e,t,n){"use strict";var i=n("e46b"),r=n("b3a6")(!0);i(i.P,"Array",{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n("0e8b")("includes")}}]);